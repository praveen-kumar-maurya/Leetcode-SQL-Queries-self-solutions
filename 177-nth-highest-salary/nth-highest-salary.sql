CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
RETURN 
(

WITH cte AS
(
SELECT *,
DENSE_RANK() OVER(ORDER BY salary DESC) AS rn
FROM employee
)

SELECT DISTINCT IFNULL(salary,NULL) 
FROM cte
WHERE rn = N
);
END